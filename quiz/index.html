<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Descubra seu programa personalizado de emagrecimento e comece sua transformação hoje.">
    <meta name="keywords" content="emagrecimento, dieta personalizada, perda de peso">
    <meta property="og:title" content="Queima Definitiva - Programa Personalizado de Emagrecimento">
    <meta property="og:description" content="Mais de 54.698 mulheres já transformaram suas vidas com o Queima Definitiva.">
    <meta property="og:image" content="../assets/logo.png">
    <meta property="og:url" content="https://seudominio.com/quiz">
    <title>Queima Definitiva</title>
    <link rel="icon" type="image/png" href="../assets/logo.png">
    
    <!-- Facebook Pixel Code -->
    <script>
        !function(f,b,e,v,n,t,s) {
            if(f.fbq)return;n=f.fbq=function(){n.callMethod?
            n.callMethod.apply(n,arguments):n.queue.push(arguments)};
            if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
            n.queue=[];t=b.createElement(e);t.async=!0;
            t.src=v;s=b.getElementsByTagName(e)[0];
            s.parentNode.insertBefore(t,s);
        }(window, document,'script','https://connect.facebook.net/en_US/fbevents.js');
        
        fbq('init', '622557317228832');
        fbq('track', 'PageView');
    </script>
    <noscript>
        <img height="1" width="1" style="display:none" 
            src="https://www.facebook.com/tr?id=622557317228832&ev=PageView&noscript=1"/>
    </noscript>
    <!-- End Facebook Pixel Code -->

    <!-- Carrega config.js primeiro -->
    <script src="/quiz/config.js"></script>
    <!-- Depois carrega o pixel-loader.js -->
    <script type="module">
        import { initializePixel, trackViewContent, trackLead } from '/pixel-loader.js';
        
        // Variáveis para controle de tempo
        let startTime = Date.now();
        let timeOnPageInterval;
        
        // Aguarda o carregamento do config.js
        window.addEventListener('config:loaded', () => {
            // Inicializa o pixel quando a configuração estiver carregada
            initializePixel();
            
            // Rastreia visualização da página
            trackViewContent('Quiz Inicial', 'quiz_start');
            fbq('track', 'ViewContent', {
                content_name: 'Quiz Inicial',
                content_category: 'Quiz',
                content_type: 'quiz_start',
                time_spent: 0
            });
            
            // Inicia o rastreamento de tempo na página
            timeOnPageInterval = setInterval(() => {
                const timeSpent = Math.floor((Date.now() - startTime) / 1000);
                if (timeSpent <= 300) { // Rastreia até 5 minutos
                    fbq('trackCustom', 'TimeOnPage', {
                        seconds: timeSpent,
                        page: 'quiz_start',
                        content_name: 'Quiz Inicial'
                    });
                } else {
                    clearInterval(timeOnPageInterval);
                }
            }, 30000); // A cada 30 segundos
            
            // Rastreia quando o usuário clica para começar o quiz
            document.querySelector('.continue-button')?.addEventListener('click', (e) => {
                e.preventDefault();
                
                const timeSpent = Math.floor((Date.now() - startTime) / 1000);
                
                // Registra o evento Lead
                fbq('track', 'Lead', {
                    content_name: 'Início do Quiz',
                    content_category: 'Quiz',
                    value: 0,
                    currency: 'BRL',
                    time_spent: timeSpent
                });
                
                // Registra o evento StartQuiz
                fbq('trackCustom', 'StartQuiz', {
                    content_name: 'Início do Quiz',
                    content_category: 'Quiz',
                    time_spent: timeSpent
                });
                
                // Usa a função de rastreamento do módulo
                trackLead({
                    content_name: 'Início do Quiz',
                    content_category: 'Quiz',
                    value: 0,
                    currency: 'BRL',
                    time_spent: timeSpent
                });
                
                // Pequeno delay para garantir que o evento seja enviado
                setTimeout(() => {
                    window.location.href = 'play.html';
                }, 300);
            });

            // Rastreia cliques em elementos da página
            document.addEventListener('click', (e) => {
                const target = e.target;
                
                // Rastreia cliques no logo
                if (target.closest('.logo')) {
                    fbq('trackCustom', 'LogoClick', {
                        content_name: 'Quiz Inicial',
                        content_category: 'Navigation',
                        time_spent: Math.floor((Date.now() - startTime) / 1000)
                    });
                }
            });
        });

        // Limpa o intervalo quando a página é fechada
        window.addEventListener('beforeunload', () => {
            if (timeOnPageInterval) {
                clearInterval(timeOnPageInterval);
            }
        });
    </script>

    <style>
        body {
            font-family: sans-serif;
            background-color: #f9f9f9;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        header {
            width: 100%;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            box-sizing: border-box;
        }

        .logo img {
            height: 30px;
        }

        nav button {
            font-size: 24px;
            background: none;
            border: none;
            cursor: pointer;
        }

        main {
            width: 100%;
            max-width: 600px;
            padding: 20px;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .hero {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .hero h1 {
            font-size: 2em;
            text-align: center;
            color: #555;
        }

        .hero img {
            width: 100%;
            max-width: 300px;
            margin: 20px auto;
            display: block;
        }

        .hero button {
            background-color: #957dad;
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.2em;
            cursor: pointer;
            border-radius: 30px;
            text-decoration: none;
        }

        .hero button a {
            color: white;
            text-decoration: none;
            display: block;
        }
    </style>
</head>
<body>
    <header>
        <div class="logo">
            <a href="../index.html">
                <img src="../assets/logo.png" alt="Queima Definitiva">
            </a>
        </div>
        <nav>
        </nav>
    </header>
    <main>
        <section class="hero">
            <h1>+ de 54.698 mulheres escolheram o Queima Definitiva</h1>
            <img src="../assets/women-collage.webp" alt="Queima Definitiva Results">
            <a href="play.html"><button class="continue-button">CONTINUAR</button></a>
        </section>
    </main>
</body>
</html>
